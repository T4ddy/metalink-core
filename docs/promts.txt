для начала ОЧЕНЬ ТЩАТЕЛЬНО ПРОСКАНИРУЙ ВЕСЬ ПРОЕКТ для поиска лучше из возможных решений.

отвечай максимально подробно и полно. пропиши все функции, даже которые повторяются. комментарии в коде на английском, само объяснения вне кода на русском. 